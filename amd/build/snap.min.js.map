{"version":3,"file":"snap.min.js","sources":["../src/snap.js"],"sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package\n * @copyright Copyright (c) 2015 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* exported snapInit */\n/* eslint no-invalid-this: \"warn\"*/\n\n/**\n * Main snap initialising function.\n */\ndefine(['jquery', 'core/log', 'theme_snap/headroom', 'theme_snap/util', 'theme_snap/personal_menu',\n        'theme_snap/cover_image', 'theme_snap/progressbar', 'core/templates', 'core/str', 'theme_snap/accessibility',\n        'theme_snap/messages', 'theme_snap/scroll'],\n    function($, log, Headroom, util, personalMenu, coverImage, ProgressBar, templates, str, accessibility, messages, Scroll) {\n\n        'use strict';\n\n        /* eslint-disable camelcase */\n        M.theme_snap = M.theme_snap || {};\n        /* eslint-enable camelcase */\n\n        /**\n         * master switch for logging\n         * @type {boolean}\n         */\n        var loggingenabled = false;\n\n        if (!loggingenabled) {\n            log.disableAll(true);\n        } else {\n            log.enableAll(true);\n        }\n\n        /**\n         * Initialize pre SCSS and grading constants.\n         * New variables can be initialized if necessary.\n         * These variables are being passed from classes/output/shared.php,\n         * and being updated from php constants in snapInit.\n         */\n        var brandColorSuccess = '';\n        var brandColorWarning = '';\n        var GRADE_DISPLAY_TYPE_PERCENTAGE = '';\n        var GRADE_DISPLAY_TYPE_PERCENTAGE_REAL = '';\n        var GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER = '';\n        var GRADE_DISPLAY_TYPE_REAL = '';\n        var GRADE_DISPLAY_TYPE_REAL_PERCENTAGE = '';\n        var GRADE_DISPLAY_TYPE_REAL_LETTER = '';\n\n        /**\n         * Get all url parameters from href\n         * @param {string} href\n         * @returns {Array}\n         */\n        var getURLParams = function(href) {\n            // Create temporary array from href.\n            var ta = href.split('?');\n            if (ta.length < 2) {\n                return false; // No url params\n            }\n            // Get url params full string from href.\n            var urlparams = ta[1];\n\n            // Strip out hash component\n            urlparams = urlparams.split('#')[0];\n\n            // Get urlparam items.\n            var items = urlparams.split('&');\n\n            // Create params array of values hashed by key.\n            var params = [];\n            for (var i = 0; i < items.length; i++) {\n                var item = items[i].split('=');\n                var key = item[0];\n                var val = item[1];\n                params[key] = val;\n            }\n            return (params);\n        };\n\n        /**\n         * Change save and cancel buttons from forms to the bottom on mobile mode.\n         */\n        $(window).on('resize', function() {\n            mobileFormChecker();\n        });\n\n        var mobileFormChecker = function() {\n            var savebuttonsformrequired = $('div[role=main] .mform div.snap-form-required fieldset > div.form-group.fitem');\n            var savebuttonsformadvanced = $('div[role=main] .mform div.snap-form-advanced > div:nth-of-type(3)');\n            var width = $(window).width();\n            if (width < 992) {\n                $('.snap-form-advanced').append(savebuttonsformrequired);\n            } else if (width > 992) {\n                $('.snap-form-required fieldset#id_general').append(savebuttonsformadvanced);\n            }\n        };\n\n        /**\n         * Move PHP errors into header\n         *\n         * @author Guy Thomas\n         * @date 2014-05-19\n         */\n        var movePHPErrorsToHeader = function() {\n            // Remove <br> tags inserted before xdebug-error.\n            var xdebugs = $('.xdebug-error');\n            if (xdebugs.length) {\n                for (var x = 0; x < xdebugs.length; x++) {\n                    var el = xdebugs[x];\n                    var fontel = el.parentNode;\n                    var br = $(fontel).prev('br');\n                    $(br).remove();\n                }\n            }\n\n            // Get messages using the different classes we want to use to target debug messages.\n            var msgs = $('.xdebug-error, .php-debug, .debuggingmessage');\n\n            if (msgs.length) {\n                // OK we have some errors - lets shove them in the footer.\n                $(msgs).addClass('php-debug-footer');\n                var errorcont = $('<div id=\"footer-error-cont\"><h3>' +\n                    M.util.get_string('debugerrors', 'theme_snap') +\n                    '</h3><hr></div>');\n                $('#page-footer').append(errorcont);\n                $('#footer-error-cont').append(msgs);\n                // Add rulers\n                $('.php-debug-footer').after($('<hr>'));\n                // Lets also add the error class to the header so we know there are some errors.\n                $('#mr-nav').addClass('errors-found');\n                // Lets add an error link to the header.\n                var errorlink = $('<a class=\"footer-error-link btn btn-danger\" href=\"#footer-error-cont\">' +\n                    M.util.get_string('problemsfound', 'theme_snap') + ' <span class=\"badge\">' + (msgs.length) + '</span></a>');\n                $('#page-header').append(errorlink);\n            }\n        };\n\n        /**\n         * Are we on the course page?\n         * Note: This doesn't mean that we are in a course - Being in a course could mean that you are on a module page.\n         * This means that you are actually on the course page.\n         * @returns {boolean}\n         */\n        var onCoursePage = function() {\n            return $('body').attr('id').indexOf('page-course-view-') === 0;\n        };\n\n        /**\n         * Apply block hash to form actions etc if necessary.\n         */\n        /* eslint-disable no-invalid-this */\n        var applyBlockHash = function() {\n            // Add block hash to add block form.\n            if (onCoursePage()) {\n                $('.block_adminblock form').each(function() {\n                    /* eslint-disable no-invalid-this */\n                    $(this).attr('action', $(this).attr('action') + '#coursetools');\n                });\n            }\n\n            if (location.hash !== '') {\n                return;\n            }\n\n            var urlParams = getURLParams(location.href);\n\n            // If calendar navigation has been clicked then go back to calendar.\n            if (onCoursePage() && typeof (urlParams.time) !== 'undefined') {\n                location.hash = 'coursetools';\n                if ($('.block_calendar_month')) {\n                    util.scrollToElement($('.block_calendar_month'));\n                }\n            }\n\n            // Form selectors for applying blocks hash.\n            var formselectors = [\n                'body.path-blocks-collect #notice form'\n            ];\n\n            // There is no decent selector for block deletion so we have to add the selector if the current url has the\n            // appropriate parameters.\n            var paramchecks = ['bui_deleteid', 'bui_editid'];\n            for (var p in paramchecks) {\n                var param = paramchecks[p];\n                if (typeof (urlParams[param]) !== 'undefined') {\n                    formselectors.push('#notice form');\n                    break;\n                }\n            }\n\n            // If required, apply #coursetools hash to form action - this is so that on submitting form it returns to course\n            // page on blocks tab.\n            $(formselectors.join(', ')).each(function() {\n                // Only apply the blocks hash if a hash is not already present in url.\n                var formurl = $(this).attr('action');\n                if (formurl.indexOf('#') === -1\n                    && (formurl.indexOf('/course/view.php') > -1)\n                ) {\n                    $(this).attr('action', $(this).attr('action') + '#coursetools');\n                }\n            });\n        };\n\n        /**\n         * Set forum strings because there isn't a decent renderer for mod/forum\n         * It would be great if the official moodle forum module used a renderer for all output\n         *\n         * @author Guy Thomas\n         * @date 2014-05-20\n         */\n        var setForumStrings = function() {\n            $('.path-mod-forum tr.discussion td.topic.starter').attr('data-cellname',\n                M.util.get_string('forumtopic', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.picture:not(\\'.group\\')').attr('data-cellname',\n                M.util.get_string('forumauthor', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.picture.group').attr('data-cellname',\n                M.util.get_string('forumpicturegroup', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.replies').attr('data-cellname',\n                M.util.get_string('forumreplies', 'theme_snap'));\n            $('.path-mod-forum tr.discussion td.lastpost').attr('data-cellname',\n                M.util.get_string('forumlastpost', 'theme_snap'));\n        };\n\n        /**\n         * Process toc search string - trim, remove case sensitivity etc.\n         *\n         * @author Guy Thomas\n         * @param {string} searchString\n         * @returns {string}\n         */\n        var processSearchString = function(searchString) {\n            searchString = searchString.trim().toLowerCase();\n            return (searchString);\n        };\n\n        /**\n         * Search course modules\n         *\n         * @author Stuart Lamour\n         * @param {array} dataList\n         */\n        var tocSearchCourse = function(dataList) {\n            // Keep search input open\n            var i;\n            var ua = window.navigator.userAgent;\n            if (ua.indexOf('MSIE ') || ua.indexOf('Trident/')) {\n                // We have reclone datalist over again for IE, or the same search fails the second time round.\n                dataList = $(\"#toc-searchables\").find('li').clone(true);\n            }\n\n            // TODO - for 2.7 process search string called too many times?\n            var searchString = $(\"#toc-search-input\").val();\n            searchString = processSearchString(searchString);\n\n            if (searchString.length === 0) {\n                $('#toc-search-results').html('');\n                $(\"#toc-search-input\").removeClass('state-active');\n\n            } else {\n                $(\"#toc-search-input\").addClass('state-active');\n                var matches = [];\n                for (i = 0; i < dataList.length; i++) {\n                    var dataItem = dataList[i];\n                    if (processSearchString($(dataItem).text()).indexOf(searchString) > -1) {\n                        matches.push(dataItem);\n                    }\n                }\n                $('#toc-search-results').html(matches);\n            }\n        };\n\n        /**\n         * Apply body classes which could not be set by renderers - e.g. when a notice was outputted.\n         * We could do this in plain CSS if there was such a think as a parent selector.\n         */\n        var bodyClasses = function() {\n            var extraclasses = [];\n            if ($('#notice.snap-continue-cancel').length) {\n                extraclasses.push('hascontinuecancel');\n            }\n            $('body').addClass(extraclasses.join(' '));\n        };\n\n        /**\n         * Listen for hash changes / popstates.\n         * @param {CourseLibAmd} courseLib\n         */\n        var listenHashChange = function(courseLib) {\n            var lastHash = location.hash;\n            $(window).on('popstate hashchange', function(e) {\n                var newHash = location.hash;\n                log.info('hashchange');\n                if (newHash !== lastHash) {\n                    if (location.hash === '#primary-nav') {\n                        personalMenu.update();\n                    } else {\n                        $('#page, #moodle-footer, #js-snap-pm-trigger, #logo, .skiplinks').css('display', '');\n                        if (onCoursePage()) {\n                            log.info('show section', e.target);\n                            courseLib.showSection();\n                        }\n                    }\n                }\n                lastHash = newHash;\n            });\n        };\n\n        /**\n         * Course footer recent activity dom re-order.\n         */\n        var recentUpdatesFix = function() {\n            $('#snap-course-footer-recent-activity .info').each(function() {\n                $(this).appendTo($(this).prev());\n            });\n            $('#snap-course-footer-recent-activity .head .name').each(function() {\n                $(this).prependTo($(this).closest(\".head\"));\n            });\n        };\n\n        /**\n         * Apply progressbar.js for circular progress displays.\n         * @param {node} nodePointer\n         * @param {function} dataCallback\n         * @param {function} valueCallback\n         */\n        var createColoredDataCircle = function(nodePointer, dataCallback, valueCallback = null) {\n            var circle = new ProgressBar.Circle(nodePointer, {\n                color: 'inherit', // @gray.\n                easing: 'linear',\n                strokeWidth: 6,\n                trailWidth: 3,\n                duration: 1400,\n                text: {\n                    value: '0'\n                }\n            });\n            var value = ($(nodePointer).attr('value') / 100);\n            var endColor = brandColorSuccess; // Green @brand-success.\n            if (value === 0 || $(nodePointer).attr('value') === '-') {\n                circle.setText('-');\n            } else {\n                if ($(nodePointer).attr('value') < 50) {\n                    endColor = brandColorWarning; // Orange @brand-warning.\n                }\n                circle.setText(dataCallback(nodePointer));\n            }\n            var valueAnimate = 0;\n\n            if (valueCallback === null) {\n                valueAnimate = value;\n            } else {\n                valueAnimate = valueCallback(nodePointer);\n            }\n            circle.animate(valueAnimate, {\n                from: {\n                    color: '#999' // @gray-light.\n                },\n                to: {\n                    color: endColor\n                },\n                step: function(state, circle) {\n                    circle.path.setAttribute('stroke', state.color);\n                }\n            });\n        };\n\n        var progressbarcircle = function() {\n            $('.snap-student-dashboard-progress .js-progressbar-circle').each(function() {\n                createColoredDataCircle(this, function(nodePointer) {\n                    return $(nodePointer).attr('value') + '<small>%</small>';\n                });\n            });\n\n            $('.snap-student-dashboard-grade .js-progressbar-circle').each(function() {\n                createColoredDataCircle(this, function(nodePointer) {\n                    var nodeValue = $(nodePointer).attr('value');\n                    var gradeFormat = $(nodePointer).attr('gradeformat');\n\n                    /**\n                     * Definitions for gradebook.\n                     *\n                     * We need to display the % for all the grade formats which contains a % in the value.\n                     */\n                    if (gradeFormat == GRADE_DISPLAY_TYPE_PERCENTAGE\n                        || gradeFormat == GRADE_DISPLAY_TYPE_PERCENTAGE_REAL\n                        || gradeFormat == GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER) {\n                        nodeValue = nodeValue + '<small>%</small>';\n                    }\n                    return nodeValue;\n                }, function(nodePointer) {\n                    var valueAnimate = $(nodePointer).attr('value');\n                    var gradeFormat = $(nodePointer).attr('gradeformat');\n\n                    if (gradeFormat == GRADE_DISPLAY_TYPE_REAL\n                        || gradeFormat == GRADE_DISPLAY_TYPE_REAL_PERCENTAGE\n                        || gradeFormat == GRADE_DISPLAY_TYPE_REAL_LETTER) {\n                        valueAnimate = 0;\n                    } else {\n                        valueAnimate = ($(nodePointer).attr('value') / 100);\n                    }\n                    return valueAnimate;\n                });\n            });\n        };\n\n        /**\n         * Add listeners.\n         *\n         * just a wrapper for various snippets that add listeners\n         * @param {object} siteConfig\n         */\n        var addListeners = function(siteConfig) {\n            var selectors = [\n                '.chapters a',\n                '.section_footer a',\n                ' #toc-search-results a'\n            ];\n\n            $(document).on('click', selectors.join(', '), function(e) {\n                var href = this.getAttribute('href');\n                if (window.history && window.history.pushState) {\n                    history.pushState(null, null, href);\n                    // Force hashchange fix for FF & IE9.\n                    $(window).trigger('hashchange');\n                    // Prevent scrolling to section.\n                    e.preventDefault();\n                } else {\n                    location.hash = href;\n                }\n            });\n\n            // Show fixed header on scroll down\n            // using headroom js - http://wicky.nillia.ms/headroom.js/\n            var myElement = document.querySelector(\"#mr-nav\");\n            // Functions added to trigger on pin and unpin actions for the nav bar\n            var onPin = () => {\n                $('.snap-drawer-no-headroom').addClass('snap-drawer-headroom');\n                $('.snap-drawer-headroom').removeClass('snap-drawer-no-headroom');\n            };\n            var onUnpin = () => {\n                $('.snap-drawer-headroom').addClass('snap-drawer-no-headroom');\n                $('.snap-drawer-no-headroom').removeClass('snap-drawer-headroom');\n            };\n            // Construct an instance of Headroom, passing the element.\n            var headroom = new Headroom(myElement, {\n                \"tolerance\": 5,\n                \"offset\": 100,\n                \"classes\": {\n                    // When element is initialised\n                    initial: \"headroom\",\n                    // When scrolling up\n                    pinned: \"headroom--pinned\",\n                    // When scrolling down\n                    unpinned: \"headroom--unpinned\",\n                    // When above offset\n                    top: \"headroom--top\",\n                    // When below offset\n                    notTop: \"headroom--not-top\"\n                },\n                \"onPin\": onPin,\n                \"onUnpin\": onUnpin\n            });\n            // When not signed in always show mr-nav?\n            if (!$('.notloggedin').length) {\n                headroom.init();\n            }\n\n            // Listener for toc search.\n            var dataList = $(\"#toc-searchables\").find('li').clone(true);\n            $('#course-toc').on('keyup', '#toc-search-input', function() {\n                tocSearchCourse(dataList);\n            });\n\n            // Handle keyboard navigation of search items.\n            $('#course-toc').on('keydown', '#toc-search-input', function(e) {\n                var keyCode = e.keyCode || e.which;\n                if (keyCode === 9) {\n                    // 9 tab\n                    // 13 enter\n                    // 40 down arrow\n                    // Register listener for exiting search result.\n                    $('#toc-search-results a').last().blur(function() {\n                        $(this).off('blur'); // Unregister listener\n                        $(\"#toc-search-input\").val('');\n                        $('#toc-search-results').html('');\n                        $(\"#toc-search-input\").removeClass('state-active');\n                    });\n\n                }\n            });\n\n            $('#course-toc').on(\"click\", '#toc-search-results a', function() {\n                $(\"#toc-search-input\").val('');\n                $('#toc-search-results').html('');\n                $(\"#toc-search-input\").removeClass('state-active');\n            });\n\n            /**\n             * When the document is clicked, if the closest object that was clicked was not the search input then close\n             * the search results.\n             * Note that this is triggered also when you click on a search result as the results should no longer be\n             * required at that point.\n             */\n            $(document).on('click', function(event) {\n                if (!$(event.target).closest('#toc-search-input').length) {\n                    $(\"#toc-search-input\").val('');\n                    $('#toc-search-results').html('');\n                    $(\"#toc-search-input\").removeClass('state-active');\n                }\n            });\n\n            // Onclick for toggle of state-visible of admin block and mobile menu.\n            $(document).on(\"click\", \"#admin-menu-trigger, #toc-mobile-menu-toggle\", function(e) {\n                var href = this.getAttribute('href');\n                // Make this only happen for settings button.\n                if (this.getAttribute('id') === 'admin-menu-trigger') {\n                    $(this).toggleClass('active');\n                    $('#page').toggleClass('offcanvas');\n                }\n                $(href).attr('tabindex', '0');\n                $(href).toggleClass('state-visible').focus();\n                e.preventDefault();\n\n                if ($('.message-app.main').length === 0) {\n                    document.dispatchEvent(new Event(\"messages-drawer:toggle\"));\n                }\n            });\n\n            // Mobile menu button.\n            $(document).on(\"click\", \"#course-toc.state-visible a\", function() {\n                $('#course-toc').removeClass('state-visible');\n            });\n\n            // Reset videos, when changing section (INT-18208).\n            $(document).on(\"click\", \".section_footer a, .chapter-title, .toc-footer a\", function() {\n                const videos = $('[title=\"watch\"], .video-js, iframe:not([id])');\n                for (let i = 0; i < videos.length; i++) {\n                    if (videos[i].classList.contains('video-js')) {\n                        if (videos[i].classList.contains('vjs-playing')) {\n                            let videoButton = videos[i].querySelector('.vjs-play-control.vjs-control.vjs-button');\n                            videoButton.click(); // Stop for videos using video-js Plugin.\n                        }\n                    } else if (videos[i].nodeName === 'IFRAME') {\n                        if (videos[i].src.includes(\"vimeo\")) {\n                            videos[i].src += \"\"; // Stop for Vimeo embedded videos.\n                        }\n                    } else {\n                        videos[i].querySelector('iframe').src += \"\"; // Stop for Youtube embedded videos.\n                    }\n                }\n            });\n\n            $(document).on('click', '.news-article .toggle', function(e) {\n                var $news = $(this).closest('.news-article');\n                var $newstoggle = $(this);\n                var $newsclose = $news.find('.news-article-message > div > a[role=\"button\"]');\n                util.scrollToElement($news);\n                $('.news-article').not($news).removeClass('state-expanded');\n                $('.news-article .toggle').not($newstoggle).attr('aria-expanded', 'false');\n                $('.news-article-message > div > a[role=\"button\"]').not($newsclose).attr('aria-expanded', 'false');\n                $('.news-article-message').css('display', 'none');\n\n                $news.toggleClass('state-expanded');\n                if (!$news.attr('state-expanded')) {\n                    $news.focus();\n                    $newstoggle.attr('aria-expanded', 'false');\n                    $newsclose.attr('aria-expanded', 'false');\n                }\n                $('.state-expanded').find('.news-article-message').slideDown(\"fast\", function() {\n                    // Animation complete.\n                    if ($news.is('.state-expanded')) {\n                        $news.find('.news-article-message').focus();\n                        $newstoggle.attr('aria-expanded', 'true');\n                        $newsclose.attr('aria-expanded', 'true');\n                    } else {\n                        $news.focus();\n                        $newstoggle.attr('aria-expanded', 'false');\n                        $newsclose.attr('aria-expanded', 'false');\n                    }\n                    $(document).trigger('snapContentRevealed');\n                });\n                e.preventDefault();\n            });\n\n            // Add listeners for pausing GIFs.\n            let imageList = [];\n            $(document).on('click', 'img[src$=\".gif\"], .paused-gif', function() {\n                let imageID = $(this).attr('id');\n                if (!(imageID in imageList)) {\n                    imageList[imageID] = $(this);\n                }\n\n                if ($(this).hasClass('paused-gif')) {\n                    $(this).replaceWith(imageList[imageID]);\n                } else {\n                    (function() {\n                        return str.get_strings([\n                            {key: 'resumegraphicsanim', component: 'theme_snap'},\n                        ]);\n                    })()\n                        .then(function(resumemessage) {\n                            return templates.render('theme_snap/animated_graphics_pause', {\n                                id: imageID,\n                                haslogo: siteConfig.hasLogo,\n                                sitename: siteConfig.shortname,\n                                resumemessage: resumemessage[0],\n                            });\n                        })\n                        .then(function(html) {\n                            $('#' + imageID).replaceWith(html);\n                        });\n                }\n            });\n\n            // Initialise the scroll event listener.\n            (new Scroll()).init();\n\n            // Bootstrap js elements.\n\n            // Initialise core bootstrap tooltip js.\n            $(function() {\n                var supportsTouch = false;\n                if ('ontouchstart' in window) {\n                    // IOS & android\n                    supportsTouch = true;\n                } else if (window.navigator.msPointerEnabled) {\n                    // Win8\n                    supportsTouch = true;\n                }\n                if (!supportsTouch) {\n                    var tooltipNode = $('[data-toggle=\"tooltip\"]');\n                    if ($.isFunction(tooltipNode.tooltip)) {\n                        tooltipNode.tooltip();\n                    }\n                }\n            });\n        };\n\n        /**\n         * Function to fix the styles when fullscreen is used with Atto Editor.\n         */\n        function waitForFullScreenButton() {\n            var maxIterations = 15;\n            var i = 0;\n            var checker = setInterval(function() {\n                i = i + 1;\n                if (i > maxIterations) {\n                    clearInterval(checker);\n                } else {\n                    if ($('button.atto_fullscreen_button').length != 0 && $('div.editor_atto').length != 0) {\n                        $('button.atto_fullscreen_button').click(function() {\n                            $('div.editor_atto').css('background-color', '#eee');\n                            $('div.editor_atto').css('z-index', '1');\n                        });\n                        $('button.atto_html_button').click(function() {\n                            $('#id_introeditor').css('z-index', '1');\n                        });\n                        clearInterval(checker);\n                    }\n                }\n            }, 2000);\n        }\n\n        /**\n         * AMD return object.\n         */\n        return {\n            /**\n             * Snap initialise function.\n             * @param {object} courseConfig\n             * @param {bool} pageHasCourseContent\n             * @param {int} siteMaxBytes\n             * @param {bool} forcePassChange\n             * @param {bool} messageBadgeCountEnabled\n             * @param {int} userId\n             * @param {bool} sitePolicyAcceptReqd\n             * @param {bool} inAlternativeRole\n             * @param {string} brandColors\n             * @param {int} gradingConstants\n             * @param {object} siteConfig\n             * @param {bool} disableSnapMyCourses\n             */\n            snapInit: function(courseConfig, pageHasCourseContent, siteMaxBytes, forcePassChange,\n                               messageBadgeCountEnabled, userId, sitePolicyAcceptReqd, inAlternativeRole,\n                               brandColors, gradingConstants, siteConfig, disableSnapMyCourses) {\n\n                // Set up.\n\n                // Branding colors. New colors can be set up if necessary.\n                brandColorSuccess = brandColors.success;\n                brandColorWarning = brandColors.warning;\n                // Grading constants for percentage.\n                GRADE_DISPLAY_TYPE_PERCENTAGE = gradingConstants.gradepercentage;\n                GRADE_DISPLAY_TYPE_PERCENTAGE_REAL = gradingConstants.gradepercentagereal;\n                GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER = gradingConstants.gradepercentageletter;\n                GRADE_DISPLAY_TYPE_REAL = gradingConstants.gradereal;\n                GRADE_DISPLAY_TYPE_REAL_PERCENTAGE = gradingConstants.graderealpercentage;\n                GRADE_DISPLAY_TYPE_REAL_LETTER = gradingConstants.graderealletter;\n\n                M.cfg.context = courseConfig.contextid;\n                M.snapTheme = {forcePassChange: forcePassChange};\n\n                // General AMD modules.\n                personalMenu.init(sitePolicyAcceptReqd);\n\n                // Course related AMD modules (note, site page can technically have course content too).\n                if (pageHasCourseContent) {\n                    require(\n                        [\n                            'theme_snap/course-lazy'\n                        ], function(CourseLibAmd) {\n                            // Instantiate course lib.\n                            var courseLib = new CourseLibAmd(courseConfig);\n\n                            // Hash change listener goes here because it requires courseLib.\n                            listenHashChange(courseLib);\n                        }\n                    );\n                }\n\n                // When document has loaded.\n                /* eslint-disable complexity */\n                $(document).ready(function() {\n                    movePHPErrorsToHeader(); // Boring\n                    setForumStrings(); // Whatever\n                    addListeners(siteConfig); // Essential\n                    applyBlockHash(); // Change location hash if necessary\n                    bodyClasses(); // Add body classes\n                    mobileFormChecker();\n\n                    // Make sure that the blocks are always within page-content for assig view page.\n                    $('#page-mod-assign-view #page-content').append($('#moodle-blocks'));\n\n                    // Append resource card fadeout to content resource card.\n                    $('.snap-resource-long .contentafterlink .snap-resource-card-fadeout').each(function() {\n                        $(this).appendTo($(this).prevAll('.snap-resource-long .contentafterlink .no-overflow'));\n                    });\n\n                    // Remove from Dom the completion tracking when it is disabled for an activity.\n                    $('.snap-header-card .snap-header-card-icons .disabled-snap-asset-completion-tracking').remove();\n\n                    // Prepend asset type when activity is a folder to appear in the card header instead of the content.\n                    var folders = $('li.snap-activity.modtype_folder');\n                    $.each(folders, function(index, folder) {\n                        var content = $(folder).find('div.contentwithoutlink div.snap-assettype');\n                        if (content.length > 0) {\n                            if ($(folder).find('div.activityinstance div.snap-header-card .asset-type').length == 0) {\n                                var folderAssetTypeHeader = $(folder).find('div.activityinstance div.snap-header-card');\n                                content.prependTo(folderAssetTypeHeader);\n                            }\n                        }\n                    });\n\n                    // Add a class to the body to show js is loaded.\n                    $('body').addClass('snap-js-loaded');\n                    // Apply progressbar.js for circluar progress display.\n                    progressbarcircle();\n                    // Course footer recent updates dom fixes.\n                    recentUpdatesFix();\n\n                    if ($('body').hasClass('pagelayout-course') || $('body').hasClass('pagelayout-frontpage')) {\n                        coverImage.courseImage(courseConfig.shortname, siteMaxBytes);\n                    } else if ($('body').hasClass('pagelayout-coursecategory')) {\n                        if (courseConfig.categoryid) {\n                            coverImage.categoryImage(courseConfig.categoryid, siteMaxBytes);\n                        }\n                    }\n\n                    // Allow deeplinking to bs tabs on snap settings page.\n                    if ($('#page-admin-setting-themesettingsnap').length) {\n                        var tabHash = location.hash;\n                        // Check link is to a tab hash.\n                        if (tabHash && $('.nav-link[href=\"' + tabHash + '\"]').length) {\n                            $('.nav-link[href=\"' + tabHash + '\"]').tab('show');\n                            $(window).scrollTop(0);\n                        }\n\n                        // Hide advanced feeds additional life time setting when advanced feeds are disabled.\n                        var changeNodeVisibilityOnChecked = function(selectorToCheck, selectorToChange) {\n                            var nodeToCheck = $(selectorToCheck),\nnodeToChange = $(selectorToChange);\n                            if (nodeToCheck.is(':checked')) {\n                                nodeToChange.show();\n                                return;\n                            }\n                            nodeToChange.hide();\n                        };\n                        var advFeedsCheckboxSelector = '#id_s_theme_snap_personalmenuadvancedfeedsenable';\n                        var advFeedsLifeTimeSelector = '#admin-personalmenuadvancedfeedslifetime';\n                        changeNodeVisibilityOnChecked(advFeedsCheckboxSelector, advFeedsLifeTimeSelector);\n                        $(advFeedsCheckboxSelector).on('click', function() {\n                            changeNodeVisibilityOnChecked(advFeedsCheckboxSelector, advFeedsLifeTimeSelector);\n                        });\n                    }\n                    // Disable enabledashboard and My courses options.\n                    if (disableSnapMyCourses) {\n                        var adminNavigationSettings = $('#page-admin-setting-navigation');\n                        if (adminNavigationSettings.length) {\n                            adminNavigationSettings.addClass(\"disable-my-courses\");\n                            if ($('#admin-enabledashboard .form-checkbox').length) {\n                                $('#admin-enabledashboard .form-checkbox input[type=\"checkbox\"]').attr(\"disabled\", true);\n                                $('#admin-enabledashboard .form-checkbox input[type=\"hidden\"]').attr(\"value\", \"1\");\n                            }\n                        }\n                        var adminStartPageSetting = $('#page-user-defaulthomepage');\n                        if (adminStartPageSetting.length) {\n                            adminStartPageSetting.addClass(\"disable-my-courses\");\n                        }\n                    }\n                    // Add extra padding when the error validation message appears at the moment of enter a not valid\n                    // URL for feature spots.\n                    var firstlinkerror = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_one_title_link span.error');\n                    var secondlinkerror = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_two_title_link span.error');\n                    var thirdlinkerror = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_three_title_link span.error');\n                    var titlelinksettingone = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_one_title_link .form-label');\n                    var titlelinksettingtwo = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_two_title_link .form-label');\n                    var titlelinksettingthree = $('#page-admin-setting-themesettingsnap #themesnapfeaturespots' +\n                        ' #admin-fs_three_title_link .form-label');\n                    // Create an extra Div to wrap title links settings to avoid line break.\n                    $('#page-admin-setting-themesettingsnap #themesnapfeaturespots ' +\n                        '#admin-fs_three_title').nextUntil('#page-admin-setting-themesettingsnap #themesnapfeaturespots ' +\n                        '#admin-fs_one_title_link_cb').wrapAll(\"<div class=fs-title-links></div>\");\n                    var linktitlestyle = {'padding-bottom': '2.1em'};\n\n                    // We need to modify the padding of these elements depending on the case, because when validating\n                    // the link and throwing an error, this will create an extra height to the parent and can break\n                    // the visualization of the settings page for Feature spots.\n                    if ((firstlinkerror).length) {\n                        titlelinksettingtwo.css(linktitlestyle);\n                        titlelinksettingthree.css(linktitlestyle);\n                    }\n                    if ((secondlinkerror).length) {\n                        titlelinksettingone.css(linktitlestyle);\n                        titlelinksettingthree.css(linktitlestyle);\n                    }\n                    if ((thirdlinkerror).length) {\n                        titlelinksettingone.css(linktitlestyle);\n                        titlelinksettingtwo.css(linktitlestyle);\n                    }\n\n                    if ($('body').hasClass('snap-pm-open')) {\n                        personalMenu.update();\n                    }\n\n                    // SHAME - make section name creation mandatory\n                    if ($('#page-course-editsection.format-topics').length) {\n                        var usedefaultname = document.getElementById('id_name_customize'),\n                            sname = document.getElementById('id_name_value');\n                        usedefaultname.value = '1';\n                        usedefaultname.checked = true;\n                        sname.required = \"required\";\n                        // Make sure that section does have at least one character.\n                        $(sname).attr(\"pattern\", \".*\\\\S+.*\");\n                        $(usedefaultname).parent().css('display', 'none');\n\n                        // Enable the cancel button.\n                        $('#id_cancel').on('click', function() {\n                            $(sname).removeAttr('required');\n                            $(sname).removeAttr('pattern');\n                            return true;\n                        });\n                    // Make sure that in other formats, \"only spaces\" name is not available.\n                    } else {\n                        $('#id_name_value').attr(\"pattern\", \".*\\\\S+.*\");\n                        $('#id_cancel').on('click', function() {\n                            $(sname).removeAttr('pattern');\n                            return true;\n                        });\n                    }\n\n                    // Book mod print button, only show if print link already present.\n                    if ($('#page-mod-book-view a[href*=\"mod/book/tool/print/index.php\"]').length) {\n                        var urlParams = getURLParams(location.href);\n                        if (urlParams) {\n                            $('[data-block=\"_fake\"]').append('<p>' +\n                                '<hr><a target=\"_blank\" href=\"/mod/book/tool/print/index.php?id=' + urlParams.id + '\">' +\n                                M.util.get_string('printbook', 'booktool_print') +\n                                '</a></p>');\n                        }\n                    }\n\n                    var modSettingsIdRe = /^page-mod-.*-mod$/; // E.g. #page-mod-resource-mod or #page-mod-forum-mod\n                    var onModSettings = modSettingsIdRe.test($('body').attr('id')) && location.href.indexOf(\"modedit\") > -1;\n                    if (!onModSettings) {\n                        modSettingsIdRe = /^page-mod-.*-general$/;\n                        onModSettings = modSettingsIdRe.test($('body').attr('id')) && location.href.indexOf(\"modedit\") > -1;\n                    }\n                    var onCourseSettings = $('body').attr('id') === 'page-course-edit';\n                    var onSectionSettings = $('body').attr('id') === 'page-course-editsection';\n                    $('#page-mod-hvp-mod .h5p-editor-iframe').parent().css({\"display\": \"block\"});\n                    var pageBlacklist = ['page-mod-hvp-mod'];\n                    var pageNotInBlacklist = pageBlacklist.indexOf($('body').attr('id')) === -1;\n\n                    if ((onModSettings || onCourseSettings || onSectionSettings) && pageNotInBlacklist) {\n                        // Wrap advanced options in a div\n                        var vital = [\n                            ':first',\n                            '#page-course-edit #id_descriptionhdr',\n                            '#id_contentsection',\n                            '#id_general + #id_general', // Turnitin duplicate ID bug.\n                            '#id_content',\n                            '#page-mod-choice-mod #id_optionhdr',\n                            '#page-mod-workshop-mod #id_gradingsettings',\n                            '#page-mod-choicegroup-mod #id_miscellaneoussettingshdr',\n                            '#page-mod-choicegroup-mod #id_groups',\n                            '#page-mod-scorm-mod #id_packagehdr'\n                        ];\n                        vital = vital.join();\n\n                        $('form[id^=\"mform1\"] > fieldset').not(vital).wrapAll('<div class=\"snap-form-advanced col-md-4\" />');\n\n                        // Add expand all to advanced column.\n                        $(\".snap-form-advanced\").append($(\".collapsible-actions\"));\n                        // Add collapsed to all fieldsets in advanced, except on course edit page.\n                        if (!$('#page-course-edit').length) {\n                            $(\".snap-form-advanced fieldset\").addClass('collapsed');\n                        }\n\n                        // Sanitize required input into a single fieldset\n                        var mainForm = $('form[id^=\"mform1\"] fieldset:first');\n                        var appendTo = $('form[id^=\"mform1\"] fieldset:first .fcontainer');\n\n                        var required = $('form[id^=\"mform1\"] > fieldset').not('form[id^=\"mform1\"] > fieldset:first');\n                        for (var i = 0; i < required.length; i++) {\n                            var content = $(required[i]).find('.fcontainer');\n                            $(appendTo).append(content);\n                            $(required[i]).remove();\n                        }\n                        $(mainForm).wrap('<div class=\"snap-form-required col-md-8\" />');\n\n                        // Show the form buttons when adding multiple LTI activities.\n                        if ($('body#page-mod-lti-mod').length) {\n                            var multipleLTIActivities =\n                                document.querySelector('section#region-main form.mform > div[data-attribute=\"dynamic-import\"]');\n                            var LTIObserver = new MutationObserver(function() {\n                                $('fieldset#id_general > :nth-child(5)').detach()\n                                    .appendTo('section#region-main > div[role=\"main\"] > form.mform');\n                            });\n                            var LTIObserverConfig = {childList: true};\n                            LTIObserver.observe(multipleLTIActivities, LTIObserverConfig);\n                        }\n\n                        var description = $('form[id^=\"mform1\"] fieldset:first .fitem_feditor:not(.required)');\n\n                        if (onModSettings && description) {\n                            var noNeedDescSelectors = [\n                                'body#page-mod-assign-mod',\n                                'body#page-mod-choice-mod',\n                                'body#page-mod-turnitintool-mod',\n                                'body#page-mod-workshop-mod',\n                            ];\n                            var addMultiMessageSelectors = [\n                                'body#page-mod-url-mod',\n                                'body#page-mod-resource-mod',\n                                'body#page-mod-folder-mod',\n                                'body#page-mod-imscp-mod',\n                                'body#page-mod-lightboxgallery-mod',\n                                'body#page-mod-scorm-mod',\n                            ];\n                            if ($(noNeedDescSelectors.join()).length === 0) {\n                                $(appendTo).append(description);\n                                $(appendTo).append($('#fitem_id_showdescription'));\n                            }\n                            // Resource cards - add a message to this type of activities, these activities will not display\n                            // any multimedia.\n                            if ($(addMultiMessageSelectors.join()).length > 0) {\n                                str.get_strings([\n                                    {key: 'multimediacard', component: 'theme_snap'}\n                                ]).done(function(stringsjs) {\n                                    var activityCards = stringsjs[0];\n                                    var cardmultimedia = $(\"[id='id_showdescription']\").closest('.form-group');\n                                    $(cardmultimedia).append(activityCards);\n                                });\n                            }\n                        }\n\n                        // Resources - put description in common mod settings.\n                        description = $(\"#page-mod-resource-mod [data-fieldtype='editor']\").closest('.form-group');\n                        var showdescription = $(\"#page-mod-resource-mod [id='id_showdescription']\").closest('.form-group');\n                        $(\"#page-mod-resource-mod .snap-form-advanced #id_modstandardelshdr .fcontainer\").append(description);\n                        $(\"#page-mod-resource-mod .snap-form-advanced #id_modstandardelshdr .fcontainer\").append(showdescription);\n\n                        // Assignment - put due date in required.\n                        var duedate = $(\"#page-mod-assign-mod [for='id_duedate']\").closest('.form-group');\n                        $(\"#page-mod-assign-mod .snap-form-required .fcontainer\").append(duedate);\n\n                        // Move availablity at the top of advanced settings.\n                        var availablity = $('#id_visible').closest('.form-group').addClass('snap-form-visibility');\n                        var label = $(availablity).find('label');\n                        var select = $(availablity).find('select');\n                        $(label).insertBefore(select);\n\n                        // SHAME - rewrite visibility form lang string to be more user friendly.\n                        $(label).text(M.util.get_string('visibility', 'theme_snap') + ' ');\n\n                        if ($(\"#page-course-edit\").length) {\n                            // We are in course editing form.\n                            // Removing the \"Show all sections in one page\" from the course format form.\n                            var strDisabled = \"\";\n                            (function() {\n                                return str.get_strings([\n                                    {key: 'showallsectionsdisabled', component: 'theme_snap'},\n                                    {key: 'disabled', component: 'theme_snap'}\n                                ]);\n                            })()\n                                .then(function(strings) {\n                                    var strMessage = strings[0];\n                                    strDisabled = strings[1];\n                                    return templates.render('theme_snap/form_alert', {\n                                        type: 'warning',\n                                        classes: '',\n                                        message: strMessage\n                                    });\n                                })\n                                .then(function(html) {\n                                    var op0 = $('[name=\"coursedisplay\"] > option[value=\"0\"]');\n                                    var op1 = $('[name=\"coursedisplay\"] > option[value=\"1\"]');\n                                    var selectNode = $('[name=\"coursedisplay\"]');\n                                    // Disable option 0\n                                    op0.attr('disabled', 'disabled');\n                                    // Add \"(Disabled)\" to option text\n                                    op0.append(' (' + strDisabled + ')');\n                                    // Remove selection attribute\n                                    op0.removeAttr(\"selected\");\n                                    // Select option 1\n                                    op1.attr('selected', 'selected');\n                                    // Add warning\n                                    selectNode.parent().append(html);\n                                });\n                        }\n\n                        $('.snap-form-advanced').prepend(availablity);\n\n                        // Add save buttons.\n                        var savebuttons = $('form[id^=\"mform1\"] > .form-group:last');\n                        $(mainForm).append(savebuttons);\n\n                        // Expand collapsed fieldsets when editing a mod that has errors in it.\n                        var errorElements = $('.form-group.has-danger');\n                        if (onModSettings && errorElements.length) {\n                            errorElements.closest('.collapsible').removeClass('collapsed');\n                        }\n\n                        // Hide appearance menu from interface when editing a page-resource.\n                        if ($(\"#page-mod-page-mod\").length) {\n                            // Chaining promises to get localized strings and render warning message.\n                            (function() {\n                                return str.get_strings([\n                                    {key: 'showappearancedisabled', component: 'theme_snap'}\n                                ]);\n                            })()\n                                .then(function(localizedstring) {\n                                    return templates.render('theme_snap/form_alert', {\n                                        type: 'warning',\n                                        classes: '',\n                                        message: localizedstring\n                                    });\n                                })\n                                // eslint-disable-next-line promise/always-return\n                                .then(function(html) {\n                                    // Disable checkboxes.\n                                    // Colors for disabling the divs.\n                                    var layoverbkcolor = \"#f1f1f1\";\n                                    var layovercolor = \"#d5d5d5\";\n                                    var pageInputs = $('[id=\"id_printheading\"], [id=\"id_printintro\"],' +\n                                        ' [id=\"id_printlastmodified\"], [id=\"id_display\"],' +\n                                        ' [id=\"id_popupwidth\"], [id=\"id_popupheight\"]');\n\n                                    // This will help with disable the multiple options for the select, and let the one by default.\n                                    // Allowing to submit the form.\n                                    $('#id_display option:not(:selected)').attr('disabled', true);\n\n                                    // Note we can't use 'disabled' for settings or they don't get submitted.\n                                    pageInputs.attr('readonly', true);\n                                    $('#id_display').attr('disabled', true);\n                                    pageInputs.attr('tabindex', -1); // Prevent tabbing to change val.\n                                    pageInputs.click(function(e) {\n                                        e.preventDefault();\n                                        return false;\n                                    });\n                                    pageInputs.parent().parent().parent().css('background-color', layoverbkcolor);\n                                    pageInputs.parent().parent().parent().css('color', layovercolor);\n\n                                    // Add warning.\n                                    var selectNode = $('#id_appearancehdrcontainer');\n                                    selectNode.append(html);\n                                });\n                            $('#id_showdescription').parent().parent().parent().hide();\n                        }\n                    }\n\n                    // Conversation counter for user badge.\n                    if (messageBadgeCountEnabled) {\n                        require(\n                            [\n                                'theme_snap/conversation_badge_count-lazy'\n                            ], function(conversationBadgeCount) {\n                                conversationBadgeCount.init(userId);\n                            }\n                        );\n                    }\n\n                    // Update Messages badge without reloading the site.\n                    $('.message-app .list-group').on('click', '.list-group-item.list-group-item-action', function(e) {\n                        require(\n                            [\n                                'theme_snap/conversation_badge_count-lazy'\n                            ], function(conversationBadgeCount) {\n                                let conversationId = e.currentTarget.attributes['data-conversation-id'].value;\n                                conversationBadgeCount.init(userId, conversationId);\n                            }\n                        );\n                    });\n\n                    // Listen to cover image label key press for accessible usage.\n                    var focustarget = $('#snap-coverimagecontrol label');\n                    if (focustarget && focustarget.length) {\n                        focustarget.keypress(function(e) {\n                            if (e.which === 13) {\n                                $('#snap-coverfiles').trigger('click');\n                            }\n                        });\n                    }\n\n                    // Review if settings block is missing.\n                    if (!$('.block_settings').length) {\n                        // Hide admin icon.\n                        $('#admin-menu-trigger').hide();\n                        if (inAlternativeRole) {\n                            // Handle possible alternative role.\n                            require(\n                                [\n                                    'theme_snap/alternative_role_handler-lazy'\n                                ], function(alternativeRoleHandler) {\n                                    alternativeRoleHandler.init(courseConfig.id);\n                                }\n                            );\n                        }\n                    }\n\n                    // Add tab logic order to navigation bar icons, part of this order is being taken from the layout nav.php file.\n                    var customMenu = $('ul.snap-navbar-content li:first-child a');\n                    var moodlePage = $(\"#moodle-page a:first\");\n                    var notificationsBtn = $('#nav-notification-popover-container > div.popover-region-toggle.nav-link');\n                    var searchButton = $('#mr-nav .simplesearchform a.btn.btn-open');\n                    var adminMenuTrigger = $('#admin-menu-trigger');\n\n                    var lastElement;\n                    if (customMenu.length) {\n                        lastElement = customMenu;\n                    } else {\n                        lastElement = moodlePage;\n                    }\n                    if (notificationsBtn.length && searchButton.length && adminMenuTrigger.length && lastElement.length) {\n                        // Update tab events because all elements have tabindex=\"0\" and they are rendered funny.\n                        require(\n                            [\n                                'theme_snap/rearrange_tab_handler-lazy'\n                            ], function(searchTabHandler) {\n                                searchTabHandler.init([notificationsBtn, searchButton, adminMenuTrigger, lastElement]);\n                            }\n                        );\n                    }\n\n                    // Add settings tab show behaviour to classes which want to do that.\n                    $('.snap-settings-tab-link').on('click', function() {\n                        var tab = $('a[href=\"' + $(this).attr('href') + '\"].nav-link');\n                        if (tab.length) {\n                            tab.tab('show');\n                        }\n                    });\n\n                    // Unpin headroom when url has #course-detail-title.\n                    if (window.location.hash === '#course-detail-title') {\n                        $('#mr-nav').removeClass('headroom--pinned').addClass('headroom--unpinned');\n                    }\n\n                    // Re position submit buttons for forms when using mobile mode at the bottom of the form.\n                    var savebuttonsformrequired = $('div[role=main] .mform div.snap-form-required fieldset > div.form-group.fitem');\n                    var width = $(window).width();\n                    if (width < 767) {\n                        $('.snap-form-advanced').append(savebuttonsformrequired);\n                    }\n\n                    // Fix a position for the new 'Send content change notification' setting.\n                    if ( $('.path-mod.theme-snap #id_coursecontentnotification').length ) {\n                        const notificationCheck = document.getElementById('id_coursecontentnotification')\n                            .closest(\".form-group.fitem\");\n                        const submitButtons = $('.snap-form-required [data-groupname=\"buttonar\"]');\n                        if (notificationCheck !== null && submitButtons.length) {\n                            notificationCheck.classList.add('snap_content_notification_check');\n                            submitButtons.before(notificationCheck);\n                        }\n                    }\n\n                    // Add container div to show Snap icons when creating and editing activities.\n                    if ( $('.path-mod.theme-snap').length ) {\n                        $( \"#region-main h2 img.icon\" ).each(function() {\n                            if($( this ).parent().attr('class') != \"activityiconcontainer\") {\n                                const newIconContainer = document.createElement(\"div\");\n                                newIconContainer.classList.add(\"activityiconcontainer\");\n                                $( this ).wrap(newIconContainer);\n                            }\n                        });\n                    }\n\n                    // Hide Blocks editing on button from the Intelliboard Dashboard page in Snap.\n                    if ( $('#page-home.theme-snap .intelliboard-page').length && $('.snap-page-heading-button').length) {\n                        const blocksEditingOnButton = document.getElementsByClassName('snap-page-heading-button')[0];\n                        blocksEditingOnButton.classList.add(\"hidden\");\n                    }\n\n                    waitForFullScreenButton();\n                });\n                accessibility.snapAxInit();\n                messages.init();\n\n                // Smooth scroll for go to top button.\n                $(\"div#goto-top-link > a\").click(function() {\n                    window.scrollTo({top: 0, behavior: 'smooth'});\n                    $('body').find('a, [tabindex=0]').first().focus();\n                });\n\n                // Blocks selectors to remove 'editing' class because is not necessary to access their settings.\n                var noneditingblocks = {};\n                noneditingblocks.blockxp = '#page-blocks-xp-index';\n\n                // Remove 'editing' class actions.\n                for (var block in noneditingblocks) {\n                    var blockisediting = $(noneditingblocks[block]).hasClass('editing');\n                    if (blockisediting === true) {\n                        $(noneditingblocks[block]).removeClass('editing');\n                    }\n                }\n\n                // Check Toggle Completion to force redirect to URL.\n                const toggleCompletion = '.togglecompletion';\n                const delay = 1500;\n                $(toggleCompletion).on('submit', function() {\n                    var shouldReload = $(toggleCompletion).hasClass('forcereload');\n                    if (shouldReload === true) {\n                        setTimeout(function() {\n                            location.reload(true);\n                        }, delay);\n                    }\n                });\n\n            }\n        };\n    }\n);\n"],"names":["define","$","log","Headroom","util","personalMenu","coverImage","ProgressBar","templates","str","accessibility","messages","Scroll","M","theme_snap","disableAll","brandColorSuccess","brandColorWarning","GRADE_DISPLAY_TYPE_PERCENTAGE","GRADE_DISPLAY_TYPE_PERCENTAGE_REAL","GRADE_DISPLAY_TYPE_PERCENTAGE_LETTER","GRADE_DISPLAY_TYPE_REAL","GRADE_DISPLAY_TYPE_REAL_PERCENTAGE","GRADE_DISPLAY_TYPE_REAL_LETTER","getURLParams","href","ta","split","length","urlparams","items","params","i","item","key","val","window","on","mobileFormChecker","savebuttonsformrequired","savebuttonsformadvanced","width","append","onCoursePage","attr","indexOf","processSearchString","searchString","trim","toLowerCase","createColoredDataCircle","nodePointer","dataCallback","valueCallback","circle","Circle","color","easing","strokeWidth","trailWidth","duration","text","value","endColor","setText","valueAnimate","animate","from","to","step","state","path","setAttribute","addListeners","siteConfig","document","join","e","this","getAttribute","history","pushState","trigger","preventDefault","location","hash","myElement","querySelector","headroom","initial","pinned","unpinned","top","notTop","addClass","removeClass","init","dataList","find","clone","ua","navigator","userAgent","html","matches","dataItem","push","tocSearchCourse","keyCode","which","last","blur","off","event","target","closest","toggleClass","focus","dispatchEvent","Event","videos","classList","contains","click","nodeName","src","includes","$news","$newstoggle","$newsclose","scrollToElement","not","css","slideDown","is","imageList","imageID","hasClass","replaceWith","get_strings","component","then","resumemessage","render","id","haslogo","hasLogo","sitename","shortname","supportsTouch","msPointerEnabled","tooltipNode","isFunction","tooltip","snapInit","courseConfig","pageHasCourseContent","siteMaxBytes","forcePassChange","messageBadgeCountEnabled","userId","sitePolicyAcceptReqd","inAlternativeRole","brandColors","gradingConstants","disableSnapMyCourses","success","warning","gradepercentage","gradepercentagereal","gradepercentageletter","gradereal","graderealpercentage","graderealletter","cfg","context","contextid","snapTheme","require","CourseLibAmd","courseLib","lastHash","newHash","info","update","showSection","listenHashChange","ready","extraclasses","xdebugs","x","fontel","parentNode","br","prev","remove","msgs","errorcont","get_string","after","errorlink","movePHPErrorsToHeader","each","urlParams","time","formselectors","paramchecks","p","formurl","applyBlockHash","appendTo","prevAll","folders","index","folder","content","folderAssetTypeHeader","prependTo","nodeValue","gradeFormat","courseImage","categoryid","categoryImage","tabHash","tab","scrollTop","changeNodeVisibilityOnChecked","selectorToCheck","selectorToChange","nodeToCheck","nodeToChange","show","hide","advFeedsCheckboxSelector","adminNavigationSettings","adminStartPageSetting","firstlinkerror","secondlinkerror","thirdlinkerror","titlelinksettingone","titlelinksettingtwo","titlelinksettingthree","nextUntil","wrapAll","linktitlestyle","usedefaultname","getElementById","sname","checked","required","parent","removeAttr","modSettingsIdRe","onModSettings","test","onCourseSettings","onSectionSettings","pageNotInBlacklist","vital","mainForm","wrap","multipleLTIActivities","MutationObserver","detach","observe","childList","description","done","stringsjs","activityCards","cardmultimedia","showdescription","duedate","availablity","label","select","insertBefore","strDisabled","strings","strMessage","type","classes","message","op0","op1","selectNode","prepend","savebuttons","errorElements","localizedstring","pageInputs","conversationBadgeCount","conversationId","currentTarget","attributes","focustarget","keypress","alternativeRoleHandler","lastElement","customMenu","moodlePage","notificationsBtn","searchButton","adminMenuTrigger","searchTabHandler","notificationCheck","submitButtons","add","before","newIconContainer","createElement","getElementsByClassName","checker","setInterval","clearInterval","waitForFullScreenButton","snapAxInit","scrollTo","behavior","first","noneditingblocks","block","setTimeout","reload"],"mappings":"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"}